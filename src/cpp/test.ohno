:trace on
:names on

:def nil 0

:def exit 0
:def qt 0
:def sel 1
:def env [1 #0 0]
:def hd [sel #0 1]
:def tl [sel #1 0]
:def k [sel #0 1]
:def pop0 [sel #1 0]
:def pop1 [sel #2 0]
:def pop2 [sel #3 0]
:def arg0 [sel #1 1]
:def arg1 [sel #2 1]
:def arg2 [sel #3 1]

:def exitenv [env exit']
:def mk21 [pop0 #21' k]
:def id [pop1 arg0 k]

:def f id

% call a function
% ![f [exitenv #21 nil]]

% stage a function call
![[env #22' id' exitenv' %] nil]



